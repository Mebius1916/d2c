<h2>Figma Plugin Demo</h2>
<div class="section">
  <h3>1. 创建图层</h3>
  <p>Count: <input id="count" value="5" type="number"></p>
  <button id="create">Create Rectangles</button>
  <button id="create-circle">Create Circle</button>
</div>

<div class="section">
  <h3>2. 读取选区</h3>
  <p>当前选中: <span id="selection-name">无</span></p>
  <button id="get-selection">获取当前选中图层名称</button>
</div>

<div class="section">
  <button id="cancel">Close Plugin</button>
</div>

<style>
  body { font-family: sans-serif; padding: 20px; }
  .section { margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #ccc; }
  button { margin-top: 8px; cursor: pointer; }
  input { width: 50px; }
</style>

<script>
// 1. 发送消息到 Sandbox (UI -> Code)
document.getElementById('create').onclick = () => {
  const textbox = document.getElementById('count');
  const count = parseInt(textbox.value, 10);
  parent.postMessage({ pluginMessage: { type: 'create-rectangles', count } }, '*')
}

document.getElementById('create-circle').onclick = () => {
  parent.postMessage({ pluginMessage: { type: 'create-circle' } }, '*')
}

document.getElementById('get-selection').onclick = () => {
  parent.postMessage({ pluginMessage: { type: 'get-selection' } }, '*')
}

document.getElementById('cancel').onclick = () => {
  parent.postMessage({ pluginMessage: { type: 'cancel' } }, '*')
}

// 2. 接收来自 Sandbox 的消息 (Code -> UI)
window.onmessage = (event) => {
  const msg = event.data.pluginMessage;
  if (msg.type === 'selection-info') {
    document.getElementById('selection-name').innerText = msg.name;
  }
}
</script>
